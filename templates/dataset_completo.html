{% extends 'base.html' %}

{% block title %}Dataset Completo{% endblock %}

{% block content %}
<div class="container mt-4">
    <h2>Dataset Completo</h2>
    
    <form method="POST" class="row g-3 mb-4">
        <!-- Filtros para variables numéricas -->
        {% for col, (min_val, max_val) in rangos.items() %}
        <div class="col-md-3">
            <label class="form-label">{{ col }} mínimo</label>
            <input type="number" name="{{ col }}_min" class="form-control" 
                   min="{{ min_val }}" max="{{ max_val }}" 
                   step="any" value="{{ filtros[col+'_min'] }}">
        </div>
        <div class="col-md-3">
            <label class="form-label">{{ col }} máximo</label>
            <input type="number" name="{{ col }}_max" class="form-control" 
                   min="{{ min_val }}" max="{{ max_val }}" 
                   step="any" value="{{ filtros[col+'_max'] }}">
        </div>
        {% endfor %}

        <!-- Filtros para variables categóricas -->
        {% for col, opciones in categorias.items() %}
        <div class="col-md-3">
            <label class="form-label">{{ col }}</label>
            <select name="{{ col }}" class="form-select">
                <option value="Todos" {% if filtros[col] == 'Todos' %}selected{% endif %}>Todos</option>
                {% for opcion in opciones %}
                    <option value="{{ opcion }}" {% if filtros[col] == opcion %}selected{% endif %}>{{ opcion }}</option>
                {% endfor %}
            </select>
        </div>
        {% endfor %}

        <div class="col-md-12">
            <button type="submit" class="btn btn-primary">Filtrar</button>
            <a href="{{ url_for('dataset_completo') }}" class="btn btn-secondary">Resetear filtros</a>
        </div>
    </form>

    <hr>
    <h4>Resultados filtrados ({{ registros_filtrados }} de {{ total_registros }} registros)</h4>
    <div class="table-responsive">
        {{ tabla_filtrada | safe }}
    </div>
    
    <hr class="my-4">
    <h4>Dataset completo ({{ total_registros }} registros)</h4>
    <div class="table-responsive">
        {{ tabla_completa | safe }}
    </div>

    <a href="{{ url_for('index') }}" class="btn btn-secondary mt-3">Volver al Inicio</a>
</div>
{% endblock %}